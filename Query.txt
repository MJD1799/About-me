*** Query ***

1)List company name,ctc which only provides one profile.

->select companyname,profilename,ctc from company natural join ((select companyid,count(distinct profileid) from offers group by companyid having count(distinct profileid)<2) as r1 natural join jobprofile natural join offers)

2)List the top three company name,cpi criteria,ctc,jobprofile which provides most    offers to   B.Tech(ICT) student having ctc>=10 LPA in last two years.

->select companyname,profilename,mincpi,ctc from ( company as r2 join
(select  cid,pid,sum(totaloffer) from pastrecruitment join offers on companyid=cid and profileid=pid and yr>2016 and yr<2018 and progname='B.Tech(ICT)' group by cid,pid order by sum(totaloffer) ) as r1 on r1.cid=r2.companyid)as r4 join jobprofile as r3 on r3.profileid=r4.pid natural join offers order by ctc desc limit 3; 



3)How many technical rounds conducted by Amazon for (SI)softwareengineer?

->select sum(noofround) as total from interviewprocessof where rid in (select roundid from interviewprocess join (select companyid,profileid from company natural join offers natural join jobprofile where companyname='Amazon' and profilename='(SI)softwareengineer') as r1 on (cid=r1.companyid and pid=r1.profileid) and (select substring(roundname,1,4)='tech'));

4)List the details of company (five comapnies)that conduct maximum number of rounds and its ctc>12LPA.
->select distinct companyname from company as c1 join
(select r1.cid,r1.pid,r1.rid,sum(noofround) as total_round from interviewprocessof as r1 join offers as r2 on r1.cid=r2.companyid and r1.pid=r2.profileid and ctc>10 group by r1.cid,r1.pid,r1.rid order by sum(noofround) desc limit 5) as r3 on c1.companyid=r3.cid;

5)List the top three online plateform name on which maximum number  of company conduct their online coding round.
->select platformname,total from (select platformname,sum(noofround) as total from interviewprocessof join interviewprocess on (rid=roundid) where (roundname='coding' and roundtype='online') group by platformname order by total desc limit 3) as r1; 

6)Give the details of interview process conducted by Directi company and no.of offers provide for (FT)platformengineer.
->select  cname,roundname,roundtype,noofround,platformname,totaloffer,progname,yr from (select companyid as cid,companyname as cname,profileid as pid,profilename,mincpi from company natural join  offers natural join jobprofile where companyname='Directi' and profilename='(FT)platformengineer')as r1 natural join pastrecruitment natural join interviewprocessof join interviewprocess on (rid=roundid);

7)give the fraction of B.Tech student of ICT(CS) and ICT who get WI+FT offer by some company by year wise.
->select cast(f1/f2 as real) as fraction,yr from((select count(distinct studentid) as f1,yr from  (pastrecruitment as r1 join jobprofile as r2 on r1.pid=r2.profileid and (select substring(profilename,2,5)='WI+FT') and (progname='B.Tech(ICT-CS)'))as r3 natural join selected group by yr)as r4 
natural join
(select count(distinct studentid) as f2,yr from  (pastrecruitment as r1 join jobprofile as r2 on r1.pid=r2.profileid and (select substring(profilename,2,5)='WI+FT') and (progname='B.Tech(ICT)'))as r3 natural join selected group by yr)as r5) where f2>0; 

8)Give the student name,email,contact_No and project details who got offer from company Morgan Stanley as software engineer stuying in 'Msc(IT)'.
->select 
studentname,emailid,contactno,progname,projectId,projectname,subjectname,companyname,profilename from 
((company natural join offers natural join jobprofile natural join student )as r1 join projectdetails on (studentid=sid) )as r2 join project on (proid=projectid) where companyname='Morgan Stanley' and (profilename='(SI)softwareengineer' or profilename='(WI)softwareengineer' or profilename='(FT)softwareengineer' or profilename='(WI+FT)softwareengineer') and progname='Msc(IT)';

9)List the students who got summer internship in a company   provides ctc>10LPA doing no more than 2 projects.
->select * from student natural join (select studentid,count(distinct proid) as total_projets from ((select * from selected join (offers natural join jobprofile) on (cid=companyid and pid=profileid) where ctc>10 and substring(profilename,2,2)='SI' ) as r1 join projectdetails on (studentid=sid))as r2 group by studentid having count(distinct proid)<3) as r3;

10)Give the questions name which is asked by all company.
->select questionid from (select questionid,cid from hasasked as r2
except
(select distinct questionid,companyid  from hasasked cross join company
except
select questionid,cid from hasasked)) as r3;



11)Give the programming questions names which have more than 1 number of tags and asked by more than one companies.
->select * from questions as r5 natural join
(select qid,count(distinct tag) as nooftag,count(distinct cid) as noofcompany from (questions natural join programmingquestions) as r1 join hasasked as r2 on r2.questionid=r1.qid group by qid having count(distinct tag)>1 and count(distinct cid)>0)as r4;

12)Give the company details which  require good communication skills and also asked more  subjective questions than programming questions.
-> select companyid,profileid,mincpi,ctc,requiredskill from offers natural join (select cid as companyid,pid as profileid from(
select cid,pid,s-pp as diff from ( 
     (select cid,pid,count(qid) as s from questions join hasasked on (qid=questionid) where flg='s' group by cid,pid)as r2
     natural join
      (select cid,pid,count(qid) as pp from questions join hasasked on (qid=questionid) where flg='p' group by cid,pid)as r3 
    ) as r5)as r6 where diff>1) as r4 join skill on(companyid=cid and profileid=pid) where requiredskill='communication';

13)Give the student details who done thier summer intern and FT in different company.
->select * from student where studentid in(
select studentid from (selected join jobprofile on (pid=profileid and substring(profilename,2,2)='SI') )
intersect
select studentid from (selected join jobprofile on (pid=profileid and substring(profilename,2,2)='FT') ));  



















